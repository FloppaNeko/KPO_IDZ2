# Контрольная работа - 2. Синхронное межсервисное взаимодействие

_Миронов Никита_

_БПИ 237_

## Микросервисная архитектура
Данное серверное приложение реализованно по прицнипу микросервисной архитиектуры и состоит из трех микросервисов:

* __APIGateway__

    Принимает запросы от пользователя и перенаправляет их двум другим микросервисам, затем передает пользователю ответ

* __FileStorageService__

    Отвечает за хранение отправленных пользователем текстовых файлов, файлы хранятся в хранилище, а данные о них (их ID, пути и имена) хранятся в базе данные Postgres

* __FileAnalysisService__

    Микросервис, отвечающий за анализ файлов, считает количество параграфов, слов и символов в файле. Также получает от стороннего сервиса изображение облака слов. Изображения также хранятся в хранилище, а данные о них (их ID, пути и имена) хранятся в базе данных Postgres

## API-эндпоинты

Информацию о эндпоинтах каждого из микросервисов можно найти в Swagger.

Кратко опишем эндпоинты микросервиса APIGateway, с которым взаимодествует пользователь.

* `POST /api/gateway/upload`

    Позволяет загрузить текстовый файл в систему, в качестве ответа возвращается JSON-файл, в котором содержится ID файла в системе

* `GET /api/gateway/{id}`

    Возвращает файл, сохраненныей в системе под данным `id`

* `GET /api/Gateway/analysis/{id}`

    Запускает анализ файла, сохраненного в системе под данным `id`. Подсчитывается количество параграфов, слов и символов в файле, также строится облако слов. Численные данные возвращаеются пользователю в JSON, облако слов сохранется в систему и может быть получено следующим запросом.

* `GET /api/gateway/wordcloud/{id}`

    Возвращает заранее построенное для файла с `id` облако слов в виде PNG-файла.

## Запуск приложения

Все микросервисы и базы данных запускаются одновременно при помощи Docker командой `docker-compose up --build`

Основное API (APIGateway) для пользователя будет запущено на порте 5000. К микросервисам можно также получить доступ напрямую через порты 5001 и 5002.

> __!!! :__ База данных Postgres при реализации данного проекта отметилась крайне нестабильной работой, так что в случае неизвестных ошибок базы данных стоит стереть создаваемый докером volume и собрать проект заново при помощи `docker-compose`







